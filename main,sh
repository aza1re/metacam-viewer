#!/bin/bash
ZIPFILE="$1"

if [ -z "$ZIPFILE" ]; then
    echo "Usage: $0 <zipfile>"
    exit 1
fi

# Unzip to a folder with the same name (without .zip)
UNZIP_DIR="${ZIPFILE%.zip}"
unzip "$ZIPFILE" -d "$UNZIP_DIR"

# Find the first .bag file
BAG_FILE=$(find "$UNZIP_DIR" -name "*.bag" | head -n 1)

if [ -z "$BAG_FILE" ]; then
    echo "No .bag file found in $UNZIP_DIR"
    exit 1
fi

# Run preprocessing
bash pp.sh "$BAG_FILE"